package model

import (
	"fmt"
	"log"
	"regexp"
	"testing"
)

func Test_PayloadPreHandle(t *testing.T) {
	res := PayloadPreHandle("GET /sys.php HTTP/1.1\r\nUser-Agent: Mozilla/5.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8", "127.0.0.1")
	log.Println("Scan:", res)
}

func Test_tcp(t *testing.T) {

	resp, err := TcpSend("tcp", "127.0.0.1:445", "hi", 5)
	log.Println("Scan:", resp, err)

}

func TestReg(t *testing.T) {
	str := `</head>
	<body>404 not found,power by <a href=" //ehang.io/nps">nps</a>`
	match, err := regexp.MatchString(`*404 not found,power by*nps`, str)
	fmt.Println("Match: ", match, " Error: ", err)
}

// b5ce1a0a3349aeeb00000000a002faf036a70000020405b40402080a00851e480000000001030307
func Test_frp(t *testing.T) {

	resp, err := TcpSend("tcp", "192.168.56.132:33456", "010000000900000000000000ff000000ff0000000000000000000000000000000200000000000000060000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002141fa120380ffff020000000000000000000000000000000000000000000000300000005b000000e0be05edfc7f0000000000000000000000000000000000006e000000770000000000000000000000dfbe05edfc7f00000000000000000000efbe05edfc7f000000000000000000007c0000000000000000000000000000007c0000000380ffff60a78e28307f00009140fa120380ffffd602000000000000b50000000000000060a78e28307f000001000000000000000013400000000000d0c105edfc7f0000000000000000000000000000000000008c875a28307f000000000000000000005001d328307f00001900000000000000967140000000000080bf05edfc7f0000a7c3400000000000-0000000001000000010000001200000054686973206e6f64652069732041646d696e00000000000000000000000000006e000000770000000000000000000000dfbe05edfc7f00000000000000000000efbe05edfc7f000000000000000000007c0000000000000000000000000000007c0000000380ffff60a78e28307f00009140fa120380ffffd602000000000000b50000000000000060a78e28307f000001000000000000000013400000000000d0c105edfc7f0000000000000000000000000000000000008c875a28307f000000000000000000005001d328307f00001900000000000000967140000000000080bf05edfc7f0000a7c3400000000000ffffffff0000000000b8ff9f9552d6e4b0bf05edfc7f00001d6e40000000000050b3af0000000000c0b3af00-01000000", 5)
	log.Println("Scan:", resp, err)

}
